---
layout: post
title: win32com excel in python
date: '2009-04-06T09:44:00.001-07:00'
author: atpic
tags: python 
modified_time: '2009-04-06T09:44:58.550-07:00'
blogger_id: tag:blogger.com,1999:blog-3924744343383394971.post-6607346207468579591
blogger_orig_url: http://tuxpython.blogspot.com/2009/04/win32com-excel-in-python.html
---

import win32com.client

def newfile(excelapp,filename):
    # workbook = excelapp.Workbooks.Open(filename) # open an existing workibook
    workbook= excelapp.Workbooks.Add() # create a new workbook
    sheet=workbook.Worksheets(1)
    # for i in range(1,10000):
    #    sheet.Cells(i,1).Value = "Hello World!"
    sheet.Range(sheet.Cells(1,1),sheet.Cells(10000,10)).Value="Hiiiiiiiiiii"
    workbook.SaveAs(filename)
    workbook.Close()


# pythoncom.CoInitializeEx(pythoncom.COINIT_APARTMENTTHREADED)
# excelapp= win32com.client.Dispatch("Excel.Application")
excelapp= win32com.client.DispatchEx("Excel.Application")
excelapp.Visible = 0 # Application should`t be visible

for i in range(1,2):
    print "doing iteration %i" % i
    newfile(excelapp,"Y:\\7196\\testxls0i" % i)
    # newfile(excelapp,"C:\\alex\\testxls0i" % i)
excelapp.Quit() # Close the WordExcel Application